<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>å…±ç”¨ä½“ï¼ˆUnionï¼‰è¯¦è§£ï¼šC++ å†…å­˜å…±äº«æœºåˆ¶</title>
    <style>
        body {
            font-family: 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%);
            color: #333;
            margin: 0;
            padding: 0;
            min-height: 100vh;
        }
        .container {
            max-width: 1000px;
            margin: 20px auto;
            padding: 20px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        header {
            text-align: center;
            padding: 20px 0;
            background: #d32f2f;
            color: white;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        h1 {
            margin: 0;
            font-size: 2.2em;
        }
        .subtitle {
            font-size: 1.1em;
            opacity: 0.9;
        }
        .tab-container {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 2px solid #ddd;
            flex-wrap: wrap;
        }
        .tab {
            padding: 15px 20px;
            cursor: pointer;
            background: #f8f9fa;
            border: none;
            flex: 1;
            min-width: 120px;
            text-align: center;
            font-size: 1.0em;
            font-weight: bold;
            color: #555;
            transition: all 0.3s;
        }
        .tab:hover {
            background: #ffebee;
        }
        .tab.active {
            background: #d32f2f;
            color: white;
        }
        .content {
            display: none;
            padding: 20px;
            background: #fdf7f8;
            border-radius: 10px;
            animation: fadeIn 0.5s;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .content.active {
            display: block;
        }
        .concept-item {
            background: white;
            padding: 15px;
            margin: 15px 0;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .concept-item h3 {
            margin-top: 0;
            color: #d32f2f;
        }
        .code {
            background: #2d3748;
            color: #f8bbd0;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            margin: 15px 0;
            line-height: 1.5;
        }
        .example {
            background: #fce4ec;
            padding: 15px;
            border-left: 5px solid #e91e63;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }
        .tip {
            background: #e3f2fd;
            border-left: 5px solid #2196f3;
            padding: 10px 15px;
            margin: 15px 0;
            border-radius: 0 6px 6px 0;
        }
        .caution {
            background: #ffebee;
            border-left: 5px solid #f44336;
            padding: 10px 15px;
            margin: 15px 0;
            border-radius: 0 6px 6px 0;
        }
        .best-practice {
            background: #f1f8e9;
            border-left: 5px solid #7cb342;
            padding: 10px 15px;
            margin: 15px 0;
            border-radius: 0 6px 6px 0;
        }
        .memory-diagram {
            text-align: center;
            margin: 15px 0;
            font-family: monospace;
            background: #fff3e0;
            padding: 10px;
            border-radius: 8px;
        }
        footer {
            text-align: center;
            margin-top: 30px;
            color: #666;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>â¤ï¸ å…±ç”¨ä½“ï¼ˆUnionï¼‰è¯¦è§£ï¼šC++ å†…å­˜å…±äº«æœºåˆ¶</h1>
            <p class="subtitle">â€”â€” è¯¾ç¨‹ï¼šC++ | æ•™å¸ˆï¼šç¨‹è€å¸ˆ | çˆ±å¿ƒ Â· åˆ›æ–° Â· åŒ å¿ƒ</p>
        </header>

        <div class="tab-container">
            <button class="tab active" onclick="openTab(event, 'intro')">ğŸ¯ ä»€ä¹ˆæ˜¯å…±ç”¨ä½“ï¼Ÿ</button>
            <button class="tab" onclick="openTab(event, 'syntax')">ğŸ“œ å£°æ˜ä¸ä½¿ç”¨</button>
            <button class="tab" onclick="openTab(event, 'vehicle')">ğŸš— è½¦è¾†ä¿¡æ¯ç®¡ç†</button>
            <button class="tab" onclick="openTab(event, 'grade')">ğŸ“Š æˆç»©ç»Ÿè®¡</button>
            <button class="tab" onclick="openTab(event, 'string')">ğŸš« ä¸ºä½•ä¸èƒ½ç”¨ stringï¼Ÿ</button>
            <button class="tab" onclick="openTab(event, 'compare')">âš–ï¸ vs ç»“æ„ä½“</button>
            <button class="tab" onclick="openTab(event, 'modern')">âœ¨ ç°ä»£æ›¿ä»£æ–¹æ¡ˆ</button>
            <button class="tab" onclick="openTab(event, 'best')">âœ… æœ€ä½³å®è·µ</button>
        </div>

        <!-- å¼•å…¥ -->
        <div id="intro" class="content active">
            <h2>ğŸ¯ ä»€ä¹ˆæ˜¯å…±ç”¨ä½“ï¼ˆUnionï¼‰ï¼Ÿ</h2>
            <div class="concept-item">
                <p><strong>å…±ç”¨ä½“ï¼ˆunionï¼‰</strong> æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ•°æ®ç±»å‹ï¼Œå…è®¸åœ¨<strong>åŒä¸€å—å†…å­˜ä½ç½®</strong>å­˜å‚¨ä¸åŒçš„æ•°æ®ç±»å‹ã€‚</p>
                <p>ä¸ç»“æ„ä½“ï¼ˆstructï¼‰ä¸åŒï¼šå…±ç”¨ä½“çš„æ‰€æœ‰æˆå‘˜<strong>å…±äº«åŒä¸€æ®µå†…å­˜</strong>ï¼Œå› æ­¤åœ¨ä»»æ„æ—¶åˆ»ï¼Œåªèƒ½æœ‰ä¸€ä¸ªæˆå‘˜æ˜¯æœ‰æ•ˆçš„ã€‚</p>
            </div>
            <div class="example">
                ğŸ’¡ åº”ç”¨åœºæ™¯ï¼šç¥ç§˜å®ç®±ï¼ˆéšæœºå‡ºé‡‘å¸æˆ–é“å…·ï¼‰ã€åè®®è§£æã€ç¡¬ä»¶å¯„å­˜å™¨æ˜ å°„ã€èŠ‚çœå†…å­˜ã€‚
            </div>
        </div>

        <!-- è¯­æ³• -->
        <div id="syntax" class="content">
            <h2>ğŸ“œ å…±ç”¨ä½“å£°æ˜ä¸ä½¿ç”¨</h2>
            <div class="concept-item">
                <h3>åŸºæœ¬è¯­æ³•</h3>
                <div class="code">
union Reward {<br>
&nbsp;&nbsp;&nbsp;&nbsp;int coins;<br>
&nbsp;&nbsp;&nbsp;&nbsp;char item[20]; // C é£æ ¼å­—ç¬¦ä¸²<br>
};<br><br>
Reward r;<br>
r.coins = 100;        // å†™å…¥ coins<br>
cout << r.coins;      // è¯»å– coinsï¼ˆæ­£ç¡®ï¼‰<br>
// cout << r.item;    // âŒ å±é™©ï¼æ­¤æ—¶ item å†…å®¹æœªå®šä¹‰
                </div>
            </div>
            <div class="caution">
                âš ï¸ **é‡è¦**ï¼šå†™å…¥ä¸€ä¸ªæˆå‘˜åï¼Œå…¶ä»–æˆå‘˜çš„å€¼æ˜¯**æœªå®šä¹‰çš„**ï¼å¿…é¡»ç”±ç¨‹åºå‘˜è‡ªå·±è·Ÿè¸ªå½“å‰æœ‰æ•ˆçš„æ˜¯å“ªä¸ªæˆå‘˜ã€‚
            </div>
        </div>

        <!-- è½¦è¾†ä¿¡æ¯ -->
        <div id="vehicle" class="content">
            <h2>ğŸš— è½¦è¾†ä¿¡æ¯ç®¡ç†ï¼ˆé¡¹ç›®æ„å»ºï¼‰</h2>
            <div class="concept-item">
                <h3>éœ€æ±‚</h3>
                <p>è®°å½•æ±½è½¦ï¼ˆè½¦ç‰Œ+å“ç‰Œï¼‰æˆ–è‡ªè¡Œè½¦ï¼ˆç¼–å·+é¢œè‰²ï¼‰ï¼Œä½¿ç”¨å…±ç”¨ä½“èŠ‚çœå†…å­˜ã€‚</p>
            </div>
            <div class="concept-item">
                <h3>å®‰å…¨å®ç°ï¼ˆå¸¦ç±»å‹æ ‡ç­¾ï¼‰</h3>
                <div class="code">
#include &lt;iostream&gt;<br>
#include &lt;cstring&gt;<br>
using namespace std;<br><br>
struct Vehicle {<br>
&nbsp;&nbsp;&nbsp;&nbsp;char type; // 'A' æ±½è½¦, 'B' è‡ªè¡Œè½¦<br>
&nbsp;&nbsp;&nbsp;&nbsp;union {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;struct { char plate[10]; char brand[20]; } car;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;struct { char id[10]; char color[10]; } bike;<br>
&nbsp;&nbsp;&nbsp;&nbsp;} data;<br>
};<br><br>
// ä½¿ç”¨ç¤ºä¾‹è§å®Œæ•´ç¨‹åº...
                </div>
            </div>
            <div class="best-practice">
                âœ… **æœ€ä½³å®è·µ**ï¼šå°†å…±ç”¨ä½“åµŒå…¥ç»“æ„ä½“ï¼Œå¹¶æ·»åŠ ä¸€ä¸ªâ€œç±»å‹æ ‡ç­¾â€ï¼ˆtagï¼‰å­—æ®µï¼Œç”¨äºè®°å½•å½“å‰å­˜å‚¨çš„æ˜¯å“ªç§æ•°æ®ã€‚
            </div>
        </div>

        <!-- æˆç»©ç»Ÿè®¡ -->
        <div id="grade" class="content">
            <h2>ğŸ“Š æˆç»©ç»Ÿè®¡ï¼ˆç­‰çº§ or åˆ†æ•°ï¼‰</h2>
            <div class="concept-item">
                <h3>éœ€æ±‚</h3>
                <p>æˆç»©ç”¨ "best/good/poor" æˆ– 0~100 åˆ†æ•°è¡¨ç¤ºï¼Œç»Ÿè®¡ç­‰çº§äººæ•°å’Œåˆ†æ•°å¹³å‡åˆ†ã€‚</p>
            </div>
            <div class="concept-item">
                <h3>å®ç°æ€è·¯</h3>
                <ul>
                    <li>ä¸éœ€è¦å…±ç”¨ä½“å­˜å‚¨æ¯ä¸ªæˆç»©ï¼ˆå› ä¸ºè¾“å…¥æ—¶å·²çŸ¥ç±»å‹ï¼‰</li>
                    <li>ä½†è‹¥è¦è®¾è®¡é€šç”¨æˆç»©ç±»å‹ï¼Œå¯å¦‚ä¸‹å®šä¹‰ï¼š</li>
                </ul>
                <div class="code">
struct Grade {<br>
&nbsp;&nbsp;&nbsp;&nbsp;bool isLevel;<br>
&nbsp;&nbsp;&nbsp;&nbsp;union {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;char level[10]; // "best"<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int score;<br>
&nbsp;&nbsp;&nbsp;&nbsp;} value;<br>
};
                </div>
            </div>
            <div class="tip">
                ğŸ’¡ æœ¬é¢˜æ›´æ¨èç›´æ¥ç”¨ä¸¤ä¸ªå˜é‡åˆ†åˆ«è®¡æ•°ï¼Œæ— éœ€å¤æ‚å…±ç”¨ä½“ã€‚
            </div>
        </div>

        <!-- string é—®é¢˜ -->
        <div id="string" class="content">
            <h2>ğŸš« ä¸ºä»€ä¹ˆå…±ç”¨ä½“ä¸­ä¸èƒ½ç›´æ¥ä½¿ç”¨ std::stringï¼Ÿ</h2>
            <div class="concept-item">
                <p><code>std::string</code> æ˜¯ä¸€ä¸ª<strong>éå¹³å‡¡ç±»å‹</strong>ï¼ˆnon-trivial typeï¼‰ï¼š</p>
                <ul>
                    <li>å®ƒæœ‰æ„é€ å‡½æ•°ã€ææ„å‡½æ•°ã€æ‹·è´èµ‹å€¼è¿ç®—ç¬¦</li>
                    <li>å®ƒå†…éƒ¨åŠ¨æ€ç®¡ç†å †å†…å­˜ï¼ˆæŒ‡é’ˆ + é•¿åº¦ + å®¹é‡ï¼‰</li>
                </ul>
                <p>è€Œä¼ ç»Ÿå…±ç”¨ä½“è¦æ±‚æ‰€æœ‰æˆå‘˜å…·æœ‰<strong>å¹³å‡¡ç”Ÿå‘½å‘¨æœŸ</strong>ï¼ˆå³å¯ä»¥ç›´æ¥æŒ‰ä½å¤åˆ¶ï¼‰ã€‚</p>
            </div>
            <div class="caution">
                âŒ å¦‚æœå¼ºè¡Œæ”¾å…¥ <code>std::string</code>ï¼Œä¼šå¯¼è‡´ï¼š
                <ul>
                    <li>ææ„å‡½æ•°è¢«é”™è¯¯è°ƒç”¨ï¼ˆå†…å­˜æ³„æ¼æˆ– double-freeï¼‰</li>
                    <li>è¡Œä¸ºæœªå®šä¹‰ï¼ˆUndefined Behaviorï¼‰</li>
                </ul>
            </div>
            <div class="best-practice">
                âœ… **è§£å†³æ–¹æ¡ˆ**ï¼š
                <ul>
                    <li>ä½¿ç”¨ C é£æ ¼å­—ç¬¦æ•°ç»„ï¼ˆ<code>char name[20]</code>ï¼‰</li>
                    <li>æˆ–ä½¿ç”¨ C++17 çš„ <code>std::variant&lt;std::string, int&gt;</code>ï¼ˆç±»å‹å®‰å…¨ï¼‰</li>
                </ul>
            </div>
        </div>

        <!-- vs ç»“æ„ä½“ -->
        <div id="compare" class="content">
            <h2>âš–ï¸ å…±ç”¨ä½“ vs ç»“æ„ä½“</h2>
            <div class="concept-item">
                <h3>å†…å­˜å¸ƒå±€å¯¹æ¯”</h3>
                <div class="memory-diagram">
// struct Point { int x; double y; };<br>
// å†…å­˜ï¼š[ x (4B) ][ padding (4B) ][ y (8B) ] â†’ æ€» 16B<br><br>

// union Data { int x; double y; };<br>
// å†…å­˜ï¼š[ æœ€å¤§æˆå‘˜çš„ç©ºé—´ (8B) ] â†’ æ€» 8B
                </div>
            </div>
            <table style="width:100%; border-collapse: collapse; margin: 15px 0;">
                <tr style="background:#ffebee;">
                    <th style="padding:10px; border:1px solid #ccc;">ç‰¹æ€§</th>
                    <th style="padding:10px; border:1px solid #ccc;">ç»“æ„ä½“ (struct)</th>
                    <th style="padding:10px; border:1px solid #ccc;">å…±ç”¨ä½“ (union)</th>
                </tr>
                <tr>
                    <td style="padding:10px; border:1px solid #ccc;">å†…å­˜å ç”¨</td>
                    <td style="padding:10px; border:1px solid #ccc;">æ‰€æœ‰æˆå‘˜ä¹‹å’Œï¼ˆ+å¯¹é½ï¼‰</td>
                    <td style="padding:10px; border:1px solid #ccc;">æœ€å¤§æˆå‘˜å¤§å°</td>
                </tr>
                <tr>
                    <td style="padding:10px; border:1px solid #ccc;">æˆå‘˜æœ‰æ•ˆæ€§</td>
                    <td style="padding:10px; border:1px solid #ccc;">æ‰€æœ‰æˆå‘˜åŒæ—¶æœ‰æ•ˆ</td>
                    <td style="padding:10px; border:1px solid #ccc;">ä»…æœ€åä¸€ä¸ªå†™å…¥çš„æˆå‘˜æœ‰æ•ˆ</td>
                </tr>
                <tr>
                    <td style="padding:10px; border:1px solid #ccc;">é€‚ç”¨åœºæ™¯</td>
                    <td style="padding:10px; border:1px solid #ccc;">ç»„åˆæ•°æ®ï¼ˆå¦‚å­¦ç”Ÿä¿¡æ¯ï¼‰</td>
                    <td style="padding:10px; border:1px solid #ccc;">äº’æ–¥æ•°æ®ï¼ˆå¦‚æ¶ˆæ¯ç±»å‹ï¼‰</td>
                </tr>
            </table>
        </div>

        <!-- ç°ä»£æ›¿ä»£ -->
        <div id="modern" class="content">
            <h2>âœ¨ ç°ä»£ C++ æ›¿ä»£æ–¹æ¡ˆï¼šstd::variant</h2>
            <div class="concept-item">
                <h3>C++17 å¼•å…¥ <code>std::variant</code></h3>
                <p>å®ƒæ˜¯ç±»å‹å®‰å…¨çš„â€œå…±ç”¨ä½“â€ï¼Œèƒ½è‡ªåŠ¨è·Ÿè¸ªå½“å‰æ´»åŠ¨ç±»å‹ï¼Œå¹¶æ­£ç¡®è°ƒç”¨æ„é€ /ææ„å‡½æ•°ã€‚</p>
                <div class="code">
#include &lt;variant&gt;<br>
#include &lt;string&gt;<br><br>
using Reward = std::variant&lt;int, std::string&gt;;<br><br>
Reward r = 100;           // å­˜ int<br>
r = std::string("Sword"); // å­˜ stringï¼Œè‡ªåŠ¨ææ„ int<br><br>
// å®‰å…¨è®¿é—®ï¼š<br>
if (std::holds_alternative&lt;int&gt;(r)) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;cout << std::get&lt;int&gt;(r);<br>
}
                </div>
            </div>
            <div class="best-practice">
                âœ… **æ¨è**ï¼šé™¤éæœ‰ä¸¥æ ¼å†…å­˜é™åˆ¶æˆ–åº•å±‚ç¼–ç¨‹éœ€æ±‚ï¼Œå¦åˆ™ä¼˜å…ˆä½¿ç”¨ <code>std::variant</code>ã€‚
            </div>
        </div>

        <!-- æœ€ä½³å®è·µ -->
        <div id="best" class="content">
            <h2>âœ… å…±ç”¨ä½“ä½¿ç”¨æœ€ä½³å®è·µ</h2>
            <div class="concept-item">
                <h3>1. å§‹ç»ˆé…åˆâ€œç±»å‹æ ‡ç­¾â€ä½¿ç”¨</h3>
                <p>å°† union åµŒå…¥ structï¼Œå¹¶ç”¨ä¸€ä¸ªå­—æ®µè®°å½•å½“å‰æœ‰æ•ˆæˆå‘˜ã€‚</p>
            </div>
            <div class="concept-item">
                <h3>2. é¿å…éå¹³å‡¡ç±»å‹</h3>
                <p>ä¸è¦åœ¨ union ä¸­ç›´æ¥ä½¿ç”¨ <code>std::string</code>ã€<code>std::vector</code> ç­‰ã€‚</p>
            </div>
            <div class="concept-item">
                <h3>3. æ˜ç¡®åº”ç”¨åœºæ™¯</h3>
                <ul>
                    <li>ç½‘ç»œ/æ–‡ä»¶åè®®è§£æï¼ˆä¸åŒæ¶ˆæ¯ç±»å‹ï¼‰</li>
                    <li>ç¡¬ä»¶å¯„å­˜å™¨æ˜ å°„ï¼ˆåŒä¸€åœ°å€ä¸åŒè§£è¯»ï¼‰</li>
                    <li>æè‡´å†…å­˜ä¼˜åŒ–ï¼ˆåµŒå…¥å¼ç³»ç»Ÿï¼‰</li>
                </ul>
            </div>
            <div class="concept-item">
                <h3>4. è€ƒè™‘ç°ä»£æ›¿ä»£å“</h3>
                <p>C++17 èµ·ï¼Œä¼˜å…ˆè€ƒè™‘ <code>std::variant</code>ï¼›C++11 èµ·å¯ç”¨ <code>boost::variant</code>ã€‚</p>
            </div>
            <div class="caution">
                â— å…±ç”¨ä½“æ˜¯å¼ºå¤§ä½†å±é™©çš„å·¥å…·ï¼Œè¯¯ç”¨ä¼šå¯¼è‡´éš¾ä»¥è°ƒè¯•çš„å†…å­˜é”™è¯¯ï¼
            </div>
        </div>

        <footer>
            <p>Â© 2025 å…±ç”¨ä½“ï¼ˆUnionï¼‰è¯¦è§£ï¼šC++ å†…å­˜å…±äº«æœºåˆ¶ | æ•™å¸ˆï¼šç¨‹è€å¸ˆ | çˆ±å¿ƒ Â· åˆ›æ–° Â· åŒ å¿ƒ</p>
        </footer>
    </div>

    <script>
        function openTab(evt, tabName) {
            const tabs = document.getElementsByClassName("tab");
            for (let i = 0; i < tabs.length; i++) {
                tabs[i].className = tabs[i].className.replace(" active", "");
            }

            const contents = document.getElementsByClassName("content");
            for (let i = 0; i < contents.length; i++) {
                contents[i].className = contents[i].className.replace(" active", "");
            }

            evt.currentTarget.className += " active";
            document.getElementById(tabName).className += " active";
        }
    </script>
</body>
</html>